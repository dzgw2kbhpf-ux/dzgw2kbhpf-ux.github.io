<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>JDM Custom Garage</title>
<style>
body { margin:0; overflow:hidden; background:#444; }
#ui {
 position:fixed;
 bottom:10px;
 left:50%;
 transform:translateX(-50%);
 background:rgba(0,0,0,0.85);
 color:white;
 padding:10px;
 border-radius:12px;
 font-size:14px;
 width:220px;
}
#ui input { width:100%; }
</style>
</head>
<body>

<div id="ui">
 車高
 <input type="range" id="ride" min="0.15" max="0.4" step="0.01" value="0.25">
 ホイールサイズ
 <input type="range" id="wheelSize" min="0.25" max="0.4" step="0.01" value="0.32">
 ホイール色
 <input type="color" id="wheelColor" value="#111111">
</div>

<script src="https://cdn.jsdelivr.net/npm/three@0.158/build/three.min.js"></script>
<script>
const scene = new THREE.Scene();
scene.background = new THREE.Color(0x666666);

const camera = new THREE.PerspectiveCamera(70, innerWidth/innerHeight, 0.1, 100);
camera.position.set(0,1.2,4);

const renderer = new THREE.WebGLRenderer({antialias:true});
renderer.setSize(innerWidth,innerHeight);
renderer.setPixelRatio(devicePixelRatio);
document.body.appendChild(renderer.domElement);

/* ライト */
scene.add(new THREE.AmbientLight(0xffffff,1.1));
const d = new THREE.DirectionalLight(0xffffff,1.5);
d.position.set(5,6,5);
scene.add(d);

/* 車全体 */
const car = new THREE.Group();
scene.add(car);

/* マテリアル */
const bodyMat = new THREE.MeshStandardMaterial({
 color:0xcc0000,
 metalness:0.6,
 roughness:0.35
});

/* ボディ構造（分割） */
// メイン
const mainBody = new THREE.Mesh(
 new THREE.BoxGeometry(1.7,0.45,3.2),
 bodyMat
);
mainBody.position.y = 0.35;
car.add(mainBody);

// ルーフ
const roof = new THREE.Mesh(
 new THREE.BoxGeometry(1.1,0.35,1.4),
 bodyMat
);
roof.position.set(0,0.7,-0.1);
car.add(roof);

// ボンネット
const hood = new THREE.Mesh(
 new THREE.BoxGeometry(1.5,0.25,1),
 bodyMat
);
hood.position.set(0,0.45,1.3);
car.add(hood);

// トランク
const trunk = new THREE.Mesh(
 new THREE.BoxGeometry(1.4,0.25,0.9),
 bodyMat
);
trunk.position.set(0,0.45,-1.4);
car.add(trunk);

// フェンダー
[-0.9,0.9].forEach(x=>{
 const f = new THREE.Mesh(
  new THREE.BoxGeometry(0.3,0.35,2.2),
  bodyMat
 );
 f.position.set(x,0.35,0);
 car.add(f);
});

/* タイヤ */
let wheels=[];
const wheelGeo = new THREE.CylinderGeometry(0.32,0.32,0.3,28);
const wheelMat = new THREE.MeshStandardMaterial({color:0x111111});

const wheelPos=[
 [-0.9,0, 1.3],[0.9,0, 1.3],
 [-0.9,0,-1.3],[0.9,0,-1.3]
];

wheelPos.forEach(p=>{
 const w = new THREE.Mesh(wheelGeo,wheelMat);
 w.rotation.z=Math.PI/2;
 w.position.set(p[0],0.18,p[2]);
 wheels.push(w);
 car.add(w);
});

/* UI */
ride.oninput=e=>{
 const y=e.target.value;
 car.children.forEach(o=>{
  if(o.geometry.type==="BoxGeometry") o.position.y=y+(o===roof?0.35:0.1);
 });
 wheels.forEach(w=>w.position.y=y-0.05);
};

wheelSize.oninput=e=>{
 wheels.forEach(w=>w.scale.set(e.target.value,e.target.value,1));
};

wheelColor.oninput=e=>{
 wheels.forEach(w=>w.material.color.set(e.target.value));
};

/* タッチ回転 */
let sx=0;
addEventListener("touchstart",e=>sx=e.touches[0].clientX);
addEventListener("touchmove",e=>{
 let dx=e.touches[0].clientX-sx;
 car.rotation.y+=dx*0.005;
 sx=e.touches[0].clientX;
});

/* アニメ */
function animate(){
 requestAnimationFrame(animate);
 renderer.render(scene,camera);
}
animate();

onresize=()=>{
 camera.aspect=innerWidth/innerHeight;
 camera.updateProjectionMatrix();
 renderer.setSize(innerWidth,innerHeight);
};
</script>
</body>
</html>
